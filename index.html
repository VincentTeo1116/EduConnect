<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EduConnect Learning Centre</title>
  <link rel="icon" href="Images/Logo.png" type="image/png">
  <style>
/* App.css */
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.form-container {
  max-width: 400px;
  margin: 20px;
  padding: 30px;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 15px;
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
  animation: fadeIn 0.6s ease-out;
  backdrop-filter: blur(10px);
}

.form-container h2 {
  text-align: center;
  margin-bottom: 25px;
  color: #333;
  font-weight: 600;
}

.form-container input, .form-container select {
  width: 100%;
  padding: 15px;
  margin: 10px 0;
  border: 2px solid #e1e5e9;
  border-radius: 10px;
  box-sizing: border-box;
  font-size: 16px;
  transition: all 0.3s ease;
  background: rgba(255, 255, 255, 0.8);
}

.form-container input:focus, .form-container select:focus {
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  outline: none;
  transform: translateY(-2px);
}

.form-container button {
  width: 100%;
  padding: 15px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  margin-top: 10px;
}

.form-container button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left 0.5s;
}

.form-container button:hover::before {
  left: 100%;
}

.form-container button:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
}

.form-container button:active {
  transform: translateY(-1px);
}

.form-container p {
  text-align: center;
  margin-top: 25px;
  color: #666;
}

.form-container p button {
  background: none;
  border: none;
  color: #667eea;
  cursor: pointer;
  text-decoration: underline;
  font-size: 14px;
  transition: color 0.3s ease;
}

.form-container p button:hover {
  color: #764ba2;
}

.main-container {
  max-width: 800px;
  margin: 20px;
  padding: 30px;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 15px;
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
  animation: fadeIn 0.6s ease-out;
  backdrop-filter: blur(10px);
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 20px 30px;
  border-radius: 12px;
  margin-bottom: 30px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

header h1 {
  margin: 0;
  font-size: 24px;
}

header button {
  background: rgba(255, 255, 255, 0.2);
  color: white;
  border: 2px solid rgba(255, 255, 255, 0.3);
  padding: 10px 20px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
}

header button:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
}

main {
  margin-top: 0;
}

section {
  background: rgba(255, 255, 255, 0.8);
  padding: 25px;
  margin-bottom: 25px;
  border-radius: 12px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
  transition: transform 0.3s ease;
}

section:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
}

section h3 {
  margin-top: 0;
  color: #333;
  font-size: 20px;
}

ul {
  list-style-type: none;
  padding: 0;
}

li {
  padding: 12px 0;
  border-bottom: 1px solid #eee;
  transition: padding-left 0.3s ease;
}

li:hover {
  padding-left: 10px;
  background: rgba(102, 126, 234, 0.05);
}

li:last-child {
  border-bottom: none;
}

.logo {
  width: 80px;
  height: auto;
  margin-right: 15px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s ease;
}

.logo:hover {
  transform: scale(1.05);
}

.hidden {
  display: none;
}
  </style>
</head>
<body>
  <div id="app">
    <!-- Login Page -->
    <div id="login-page" class="form-container">
      <div style="text-align: center; margin-bottom: 20px;">
        <img src="Images/Logo.png" alt="EduConnect Logo" class="logo">
      </div>
      <h2>Login to EduConnect</h2>
      <form id="login-form">
        <input type="email" id="login-email" placeholder="Email" required>
        <input type="password" id="login-password" placeholder="Password" required>
        <button type="submit">Login</button>
      </form>
    </div>

    <!-- Register Page -->
    <div id="register-page" class="form-container hidden">
      <div style="text-align: center; margin-bottom: 20px;">
        <img src="Images/Logo.png" alt="EduConnect Logo" class="logo">
      </div>
      <h2>Register for EduConnect</h2>
      <form id="register-form">
        <input type="text" id="register-name" placeholder="Name" required>
        <input type="email" id="register-email" placeholder="Email" required>
        <input type="password" id="register-password" placeholder="Password" required>
        <select id="register-role" required>
          <option value="">Select Role</option>
          <option value="Student">Student</option>
          <option value="Instructor">Instructor</option>
          <option value="Exam Administrator">Exam Administrator</option>
        </select>
        <button type="submit">Register</button>
      </form>
    </div>

    <!-- Student Dashboard -->
    <div id="student-dashboard" class="main-container hidden">
      <header>
        <div style="display: flex; align-items: center;">
          <img src="Images/Logo.png" alt="EduConnect Logo" class="logo">
          <h1>Welcome, <span id="student-name"></span> (Student)</h1>
        </div>
        <div>
          <button id="student-profile-btn">Profile</button>
          <button id="student-logout-btn">Logout</button>
        </div>
      </header>
      <main>
        <section>
          <h3>My Assessments</h3>
          <div id="student-assessments"></div>
        </section>
        <section>
          <h3>Ask a Question</h3>
          <form id="student-question-form">
            <select id="question-assessment" required>
              <option value="">Select Assessment</option>
            </select>
            <textarea id="question-text" placeholder="Question" required></textarea>
            <button type="submit">Ask</button>
          </form>
        </section>
        <section>
          <h3>Chatbot</h3>
          <input type="password" id="chatbot-api-key" placeholder="DeepSeek API Key">
          <form id="chatbot-form">
            <input type="text" id="chatbot-query" placeholder="Ask me anything" required>
            <button type="submit">Ask</button>
          </form>
          <p id="chatbot-response"></p>
        </section>
      </main>
    </div>

    <!-- Instructor Dashboard -->
    <div id="instructor-dashboard" class="main-container hidden">
      <header>
        <div style="display: flex; align-items: center;">
          <img src="Images/Logo.png" alt="EduConnect Logo" class="logo">
          <h1>Welcome, <span id="instructor-name"></span> (Instructor)</h1>
        </div>
        <div>
          <button id="instructor-profile-btn">Profile</button>
          <button id="instructor-logout-btn">Logout</button>
        </div>
      </header>
      <main>
        <section>
          <h3>Create Assessment</h3>
          <form id="assessment-form">
            <input type="text" id="assessment-title" placeholder="Title" required>
            <textarea id="assessment-description" placeholder="Description" required></textarea>
            <input type="text" id="assessment-course" placeholder="Course" required>
            <input type="datetime-local" id="assessment-deadline" required>
            <textarea id="assessment-criteria" placeholder="Grading Criteria" required></textarea>
            <button type="submit">Create</button>
          </form>
        </section>
        <section>
          <h3>Submissions</h3>
          <div id="instructor-submissions"></div>
        </section>
        <section>
          <h3>Questions</h3>
          <div id="instructor-questions"></div>
        </section>
      </main>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-dashboard" class="main-container hidden">
      <header>
        <div style="display: flex; align-items: center;">
          <img src="Images/Logo.png" alt="EduConnect Logo" class="logo">
          <h1>Welcome, <span id="admin-name"></span> (Admin)</h1>
        </div>
        <div>
          <button id="admin-profile-btn">Profile</button>
          <button id="admin-logout-btn">Logout</button>
        </div>
      </header>
      <main>
        <section>
          <h3>Create User Account</h3>
          <form id="admin-create-user-form">
            <input type="text" id="admin-user-name" placeholder="Name" required>
            <input type="email" id="admin-user-email" placeholder="Email" required>
            <input type="password" id="admin-user-password" placeholder="Password" required>
            <select id="admin-user-role" required>
              <option value="">Select Role</option>
              <option value="Student">Student</option>
              <option value="Instructor">Instructor</option>
              <option value="Exam Administrator">Exam Administrator</option>
            </select>
            <button type="submit">Create User</button>
          </form>
        </section>
        <section>
          <h3>Manage Users</h3>
          <div id="admin-users"></div>
        </section>
        <section>
          <h3>Approve Grades</h3>
          <div id="admin-grades"></div>
        </section>
      </main>
    </div>

    <!-- Profile Page -->
    <div id="profile-page" class="main-container hidden">
      <header>
        <div style="display: flex; align-items: center;">
          <img src="Images/Logo.png" alt="EduConnect Logo" class="logo">
          <h1>Profile</h1>
        </div>
        <div>
          <button id="profile-back-btn">Back</button>
          <button id="profile-logout-btn">Logout</button>
        </div>
      </header>
      <main>
        <section>
          <h3>Update Profile</h3>
          <form id="profile-form">
            <input type="text" id="profile-name" placeholder="Name" required>
            <input type="email" id="profile-email" placeholder="Email" required>
            <button type="submit">Update</button>
          </form>
        </section>
      </main>
    </div>
  </div>

  <script>
    // Data storage
    let users = JSON.parse(localStorage.getItem('users')) || [];
    let assessments = JSON.parse(localStorage.getItem('assessments')) || [];
    let submissions = JSON.parse(localStorage.getItem('submissions')) || [];
    let questions = JSON.parse(localStorage.getItem('questions')) || [];
    let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;

    // Utility functions
    function showPage(pageId) {
      document.querySelectorAll('#app > div').forEach(div => div.classList.add('hidden'));
      document.getElementById(pageId).classList.remove('hidden');
    }

    function saveData() {
      localStorage.setItem('users', JSON.stringify(users));
      localStorage.setItem('assessments', JSON.stringify(assessments));
      localStorage.setItem('submissions', JSON.stringify(submissions));
      localStorage.setItem('questions', JSON.stringify(questions));
      if (currentUser) localStorage.setItem('currentUser', JSON.stringify(currentUser));
    }

    // Initialize
    if (currentUser) {
      if (currentUser.role === 'Student') showStudentDashboard();
      else if (currentUser.role === 'Instructor') showInstructorDashboard();
      else if (currentUser.role === 'Exam Administrator') showAdminDashboard();
      else showPage('login-page');
    } else if (users.length === 0) {
      showPage('register-page');
    } else {
      showPage('login-page');
    }

    // Login
    document.getElementById('login-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      const user = users.find(u => u.email === email && u.password === password && u.active !== false);
      if (user) {
        currentUser = user;
        saveData();
        if (user.role === 'Student') showStudentDashboard();
        else if (user.role === 'Instructor') showInstructorDashboard();
        else if (user.role === 'Exam Administrator') showAdminDashboard();
      } else {
        alert('Invalid credentials or account deactivated');
      }
    });

    // Register
    document.getElementById('register-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('register-name').value;
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;
      const role = document.getElementById('register-role').value;
      if (users.find(u => u.email === email)) {
        alert('User already exists');
        return;
      }
      const newUser = { id: Date.now(), name, email, password, role, active: true };
      users.push(newUser);
      currentUser = newUser;
      saveData();
      if (role === 'Student') showStudentDashboard();
      else if (role === 'Instructor') showInstructorDashboard();
      else if (role === 'Exam Administrator') showAdminDashboard();
    });

    // Logout
    function logout() {
      currentUser = null;
      localStorage.removeItem('currentUser');
      showPage('login-page');
    }

    document.getElementById('student-logout-btn').addEventListener('click', logout);
    document.getElementById('instructor-logout-btn').addEventListener('click', logout);
    document.getElementById('admin-logout-btn').addEventListener('click', logout);
    document.getElementById('profile-logout-btn').addEventListener('click', logout);

    // Profile
    function showProfile() {
      document.getElementById('profile-name').value = currentUser.name;
      document.getElementById('profile-email').value = currentUser.email;
      showPage('profile-page');
    }

    document.getElementById('student-profile-btn').addEventListener('click', showProfile);
    document.getElementById('instructor-profile-btn').addEventListener('click', showProfile);
    document.getElementById('admin-profile-btn').addEventListener('click', showProfile);

    document.getElementById('profile-form').addEventListener('submit', function(e) {
      e.preventDefault();
      currentUser.name = document.getElementById('profile-name').value;
      currentUser.email = document.getElementById('profile-email').value;
      users = users.map(u => u.id === currentUser.id ? currentUser : u);
      saveData();
      alert('Profile updated');
      if (currentUser.role === 'Student') showStudentDashboard();
      else if (currentUser.role === 'Instructor') showInstructorDashboard();
      else if (currentUser.role === 'Exam Administrator') showAdminDashboard();
    });

    document.getElementById('profile-back-btn').addEventListener('click', function() {
      if (currentUser.role === 'Student') showStudentDashboard();
      else if (currentUser.role === 'Instructor') showInstructorDashboard();
      else if (currentUser.role === 'Exam Administrator') showAdminDashboard();
    });

    // Student Dashboard
    function showStudentDashboard() {
      document.getElementById('student-name').textContent = currentUser.name;
      const assessmentsDiv = document.getElementById('student-assessments');
      assessmentsDiv.innerHTML = assessments.map(a => `
        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">
          <h4>${a.title}</h4>
          <p>${a.description}</p>
          <p>Deadline: ${a.deadline}</p>
          <button onclick="submitAssessment(${a.id})">Submit</button>
        </div>
      `).join('');
      const questionSelect = document.getElementById('question-assessment');
      questionSelect.innerHTML = '<option value="">Select Assessment</option>' + assessments.map(a => `<option value="${a.id}">${a.title}</option>`).join('');
      showPage('student-dashboard');
    }

    function submitAssessment(assessmentId) {
      const submission = {
        id: Date.now(),
        assessmentId,
        studentId: currentUser.id,
        files: 'file.pdf',
        drafts: [{ version: 1, content: 'file.pdf', timestamp: new Date().toISOString() }],
        grade: null,
        feedback: '',
        status: 'submitted'
      };
      submissions.push(submission);
      saveData();
      alert('Submission successful');
    }

    document.getElementById('student-question-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const assessmentId = document.getElementById('question-assessment').value;
      const question = document.getElementById('question-text').value;
      const q = { id: Date.now(), assessmentId: parseInt(assessmentId), studentId: currentUser.id, question, answers: [] };
      questions.push(q);
      saveData();
      document.getElementById('student-question-form').reset();
      alert('Question submitted');
    });

    // Chatbot
    document.getElementById('chatbot-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const apiKey = document.getElementById('chatbot-api-key').value;
      localStorage.setItem('chatbotApiKey', apiKey);
      const query = document.getElementById('chatbot-query').value;
      const response = 'Chatbot response: ' + query + ' (API integration pending)';
      document.getElementById('chatbot-response').textContent = response;
    });

    // Instructor Dashboard
    function showInstructorDashboard() {
      document.getElementById('instructor-name').textContent = currentUser.name;
      const submissionsDiv = document.getElementById('instructor-submissions');
      submissionsDiv.innerHTML = submissions.filter(s => assessments.find(a => a.id === s.assessmentId && a.instructorId === currentUser.id)).map(s => `
        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">
          <p>Student: ${users.find(u => u.id === s.studentId)?.name}</p>
          <input type="number" placeholder="Grade" onchange="gradeSubmission(${s.id}, this.value)">
          <textarea placeholder="Feedback" onchange="updateFeedback(${s.id}, this.value)">${s.feedback}</textarea>
        </div>
      `).join('');
      const questionsDiv = document.getElementById('instructor-questions');
      questionsDiv.innerHTML = questions.map(q => `
        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">
          <p>${q.question}</p>
          <textarea placeholder="Answer" onchange="answerQuestion(${q.id}, this.value)"></textarea>
        </div>
      `).join('');
      showPage('instructor-dashboard');
    }

    document.getElementById('assessment-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const title = document.getElementById('assessment-title').value;
      const description = document.getElementById('assessment-description').value;
      const course = document.getElementById('assessment-course').value;
      const deadline = document.getElementById('assessment-deadline').value;
      const criteria = document.getElementById('assessment-criteria').value;
      const assessment = { id: Date.now(), title, description, course, deadline, criteria, instructorId: currentUser.id, files: [] };
      assessments.push(assessment);
      saveData();
      document.getElementById('assessment-form').reset();
      alert('Assessment created');
    });

    function gradeSubmission(submissionId, grade) {
      const sub = submissions.find(s => s.id === submissionId);
      if (sub) {
        sub.grade = grade;
        sub.status = 'graded';
        saveData();
      }
    }

    function updateFeedback(submissionId, feedback) {
      const sub = submissions.find(s => s.id === submissionId);
      if (sub) {
        sub.feedback = feedback;
        saveData();
      }
    }

    function answerQuestion(questionId, answer) {
      const q = questions.find(q => q.id === questionId);
      if (q) {
        q.answers.push({ instructorId: currentUser.id, answer, official: true, resolved: false });
        saveData();
      }
    }

    // Admin Dashboard
    function showAdminDashboard() {
      document.getElementById('admin-name').textContent = currentUser.name;
      const usersDiv = document.getElementById('admin-users');
      usersDiv.innerHTML = users.map(u => `
        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">
          <p>${u.name} - ${u.role} - ${u.active ? 'Active' : 'Inactive'}</p>
          <button onclick="toggleUser(${u.id})">${u.active ? 'Deactivate' : 'Activate'}</button>
        </div>
      `).join('');
      const gradesDiv = document.getElementById('admin-grades');
      gradesDiv.innerHTML = submissions.filter(s => s.status === 'graded').map(s => `
        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">
          <p>Grade: ${s.grade}</p>
          <button onclick="approveGrade(${s.id})">Approve</button>
        </div>
      `).join('');
      showPage('admin-dashboard');
    }

    document.getElementById('admin-create-user-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('admin-user-name').value;
      const email = document.getElementById('admin-user-email').value;
      const password = document.getElementById('admin-user-password').value;
      const role = document.getElementById('admin-user-role').value;
      if (users.find(u => u.email === email)) {
        alert('User already exists');
        return;
      }
      const newUser = { id: Date.now(), name, email, password, role, active: true };
      users.push(newUser);
      saveData();
      document.getElementById('admin-create-user-form').reset();
      alert('User created');
      showAdminDashboard();
    });

    function toggleUser(userId) {
      const user = users.find(u => u.id === userId);
      if (user) {
        user.active = !user.active;
        saveData();
        showAdminDashboard();
      }
    }

    function approveGrade(submissionId) {
      const sub = submissions.find(s => s.id === submissionId);
      if (sub) {
        sub.status = 'approved';
        saveData();
        showAdminDashboard();
      }
    }
  </script>
</body>
</html>